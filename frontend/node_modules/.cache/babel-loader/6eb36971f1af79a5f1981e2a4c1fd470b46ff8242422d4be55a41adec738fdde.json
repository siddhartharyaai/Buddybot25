{"ast":null,"code":"import React,{useState,useRef,useEffect,useCallback}from'react';import{motion,AnimatePresence}from'framer-motion';import{MicrophoneIcon,StopIcon,PaperAirplaneIcon,SpeakerWaveIcon,SpeakerXMarkIcon,SparklesIcon,ChatBubbleLeftEllipsisIcon,SunIcon,MoonIcon}from'@heroicons/react/24/outline';import toast from'react-hot-toast';import TextInput from'./TextInput';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SimplifiedChatInterface=_ref=>{let{user,darkMode,setDarkMode,sessionId,messages,onAddMessage}=_ref;const[isRecording,setIsRecording]=useState(false);const[isPlaying,setIsPlaying]=useState(false);const[isLoading,setIsLoading]=useState(false);const[isBotSpeaking,setIsBotSpeaking]=useState(false);const[currentTranscript,setCurrentTranscript]=useState('');const[recordingTimer,setRecordingTimer]=useState(0);const mediaRecorderRef=useRef(null);const audioChunksRef=useRef([]);const messagesEndRef=useRef(null);const audioRef=useRef(null);const recordingIntervalRef=useRef(null);const streamRef=useRef(null);const suggestions=[\"Tell me a story\",\"Sing a song\",\"What's a fun fact?\",\"Let's play a game\",\"Help me learn something\"];useEffect(()=>{scrollToBottom();},[messages]);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});};const startRecording=async()=>{try{console.log('Starting recording...');// Reset states\nsetCurrentTranscript('');setRecordingTimer(0);const stream=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16000,channelCount:1,echoCancellation:true,noiseSuppression:true,autoGainControl:true}});streamRef.current=stream;// Use higher quality audio recording\nconst options={mimeType:'audio/webm;codecs=opus',audioBitsPerSecond:128000};// Fallback for browsers that don't support webm\nif(!MediaRecorder.isTypeSupported(options.mimeType)){options.mimeType='audio/wav';}mediaRecorderRef.current=new MediaRecorder(stream,options);audioChunksRef.current=[];mediaRecorderRef.current.ondataavailable=event=>{if(event.data.size>0){audioChunksRef.current.push(event.data);console.log('Audio chunk received:',event.data.size,'bytes');}};mediaRecorderRef.current.onstop=()=>{console.log('Recording stopped, processing audio...');const audioBlob=new Blob(audioChunksRef.current,{type:mediaRecorderRef.current.mimeType});console.log('Audio blob created:',audioBlob.size,'bytes, type:',audioBlob.type);sendVoiceMessage(audioBlob);// Clean up stream\nif(streamRef.current){streamRef.current.getTracks().forEach(track=>track.stop());streamRef.current=null;}};// Start recording with chunks every 100ms for better quality\nmediaRecorderRef.current.start(100);setIsRecording(true);// Add a live transcript message\nconst liveMessage={id:\"recording-\".concat(Date.now()),type:'user',content:'ðŸŽ¤ Recording... (hold to continue)',isVoice:true,isLive:true,timestamp:new Date()};onAddMessage(liveMessage);// Start recording timer\nrecordingIntervalRef.current=setInterval(()=>{setRecordingTimer(prev=>prev+1);},1000);console.log('Recording started successfully');}catch(error){console.error('Microphone access error:',error);toast.error(\"Microphone access denied: \".concat(error.message));}};const stopRecording=()=>{console.log('Stopping recording...');if(mediaRecorderRef.current&&isRecording){mediaRecorderRef.current.stop();setIsRecording(false);setRecordingTimer(0);// Clear recording timer\nif(recordingIntervalRef.current){clearInterval(recordingIntervalRef.current);recordingIntervalRef.current=null;}// Remove live recording message by filtering it from current messages\n// Since we can't modify the messages directly, we'll need to update the approach\n// For now, we'll add a cleanup mechanism in the parent component\nconsole.log('Recording stop initiated');}};const sendVoiceMessage=async audioBlob=>{console.log('Sending voice message, blob size:',audioBlob.size,'type:',audioBlob.type);// Validate audio blob\nif(!audioBlob||audioBlob.size===0){console.error('Invalid audio blob');toast.error('Recording failed - no audio data');return;}// Create temporary user message for processing\nconst userMessage={id:Date.now(),type:'user',content:'ðŸŽ¤ Processing voice...',isVoice:true,timestamp:new Date()};onAddMessage(userMessage);setIsLoading(true);try{// Convert audio blob to ArrayBuffer first for better handling\nconst arrayBuffer=await audioBlob.arrayBuffer();const uint8Array=new Uint8Array(arrayBuffer);const base64Audio=btoa(String.fromCharCode(...uint8Array));console.log('Audio converted to base64, length:',base64Audio.length);// Create form data with proper content type\nconst formData=new FormData();formData.append('session_id',sessionId);formData.append('user_id',user.id);formData.append('audio_base64',base64Audio);console.log('Sending request to voice endpoint...');const response=await fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/voice/process_audio\"),{method:'POST',body:formData});const data=await response.json();console.log('Voice processing response:',data);if(response.ok&&data.status==='success'){// Add AI response\nconst aiMessage={id:Date.now()+1,type:'ai',content:data.response_text||'I heard you!',audioData:data.response_audio,contentType:data.content_type,metadata:data.metadata,timestamp:new Date()};onAddMessage(aiMessage);// Auto-play AI response if available\nif(data.response_audio){playAudio(data.response_audio);}toast.success('Voice message processed!');}else{throw new Error(data.detail||data.message||'Voice processing failed');}}catch(error){console.error('Voice message error:',error);toast.error(\"Voice processing failed: \".concat(error.message));// Add error message since we can't update existing message\nconst errorMessage={id:Date.now()+1,type:'system',content:'âŒ Voice processing failed - try again',timestamp:new Date()};onAddMessage(errorMessage);}finally{setIsLoading(false);}};const sendTextMessage=async messageText=>{if(!messageText||!messageText.trim()||isLoading)return;const messageContent=messageText.trim();const userMessage={id:Date.now(),type:'user',content:messageContent,isVoice:false,timestamp:new Date()};onAddMessage(userMessage);setIsLoading(true);try{const response=await fetch(\"\".concat(process.env.REACT_APP_BACKEND_URL,\"/api/conversations/text\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({session_id:sessionId,user_id:user.id,message:messageContent})});const data=await response.json();if(response.ok){const aiMessage={id:Date.now()+1,type:'ai',content:data.response_text,audioData:data.response_audio,contentType:data.content_type,metadata:data.metadata,timestamp:new Date()};onAddMessage(aiMessage);// Auto-play AI response\nif(data.response_audio){playAudio(data.response_audio);}}else{throw new Error(data.detail||'Failed to send message');}}catch(error){toast.error('Failed to send message');console.error('Text message error:',error);}finally{setIsLoading(false);}};const playAudio=base64Audio=>{if(audioRef.current){audioRef.current.pause();}const audioBlob=new Blob([Uint8Array.from(atob(base64Audio),c=>c.charCodeAt(0))],{type:'audio/wav'});const audioUrl=URL.createObjectURL(audioBlob);audioRef.current=new Audio(audioUrl);audioRef.current.play();setIsPlaying(true);setIsBotSpeaking(true);audioRef.current.onended=()=>{setIsPlaying(false);setIsBotSpeaking(false);URL.revokeObjectURL(audioUrl);};};const stopAudio=()=>{if(audioRef.current){audioRef.current.pause();audioRef.current.currentTime=0;setIsPlaying(false);setIsBotSpeaking(false);}};const formatTime=timestamp=>{// Ensure timestamp is a Date object\nconst date=timestamp instanceof Date?timestamp:new Date(timestamp);// Handle invalid dates\nif(isNaN(date.getTime())){return new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});}return date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});};const handleMicPress=e=>{e.preventDefault();console.log('Mic button pressed');if(!isRecording&&!isLoading){startRecording();}};const handleMicRelease=e=>{e.preventDefault();console.log('Mic button released');if(isRecording){stopRecording();}};// Handle keyboard interactions\nconst handleMicKeyDown=e=>{if(e.key===' '||e.key==='Enter'){e.preventDefault();handleMicPress(e);}};const handleMicKeyUp=e=>{if(e.key===' '||e.key==='Enter'){e.preventDefault();handleMicRelease(e);}};// Cleanup on unmount\nuseEffect(()=>{return()=>{if(recordingIntervalRef.current){clearInterval(recordingIntervalRef.current);}if(streamRef.current){streamRef.current.getTracks().forEach(track=>track.stop());}};},[]);// Dynamic background based on bot speaking\nconst getBackgroundClass=()=>{const base=darkMode?'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900':'bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50';if(isBotSpeaking){return darkMode?'bg-gradient-to-br from-purple-900 via-pink-900 to-orange-900':'bg-gradient-to-br from-yellow-100 via-orange-100 to-pink-100';}return base;};return/*#__PURE__*/_jsx(\"div\",{className:\"h-full \".concat(getBackgroundClass(),\" transition-all duration-1000\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"h-full flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0 p-4 border-b \".concat(darkMode?'border-gray-700 bg-gray-900':'border-gray-200 bg-gray-50'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(ChatBubbleLeftEllipsisIcon,{className:\"w-6 h-6 \".concat(darkMode?'text-blue-400':'text-blue-600')}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Chat with Buddy \\uD83E\\uDD16\"}),isRecording&&/*#__PURE__*/_jsxs(motion.div,{className:\"flex items-center space-x-2 text-red-500\",animate:{opacity:[1,0.5,1]},transition:{duration:1,repeat:Infinity},children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-red-500 rounded-full\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm font-medium\",children:[\"Recording \",recordingTimer,\"s\"]})]}),isBotSpeaking&&/*#__PURE__*/_jsxs(motion.div,{className:\"flex items-center space-x-2 text-blue-500\",animate:{opacity:[1,0.7,1]},transition:{duration:0.8,repeat:Infinity},children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 bg-blue-500 rounded-full\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium\",children:\"Speaking...\"})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setDarkMode(!darkMode),className:\"p-2 rounded-full transition-colors \".concat(darkMode?'bg-gray-700 text-yellow-400 hover:bg-gray-600':'bg-gray-100 text-gray-600 hover:bg-gray-200'),children:darkMode?/*#__PURE__*/_jsx(SunIcon,{className:\"w-5 h-5\"}):/*#__PURE__*/_jsx(MoonIcon,{className:\"w-5 h-5\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:[messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"mx-auto w-32 h-32 rounded-full flex items-center justify-center mb-6 \".concat(darkMode?'bg-gradient-to-br from-blue-600 to-purple-700':'bg-gradient-to-br from-blue-500 to-purple-600'),animate:{scale:isBotSpeaking?[1,1.05,1]:[1,1.02,1]},transition:{scale:{duration:2,repeat:Infinity,ease:\"easeInOut\"}},children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(motion.div,{className:\"w-4 h-8 bg-white rounded-full\",animate:{scaleY:isBotSpeaking?[1,0.3,1]:[1,0.8,1]},transition:{duration:2,repeat:Infinity,ease:\"easeInOut\"}}),/*#__PURE__*/_jsx(motion.div,{className:\"w-4 h-8 bg-white rounded-full\",animate:{scaleY:isBotSpeaking?[1,0.3,1]:[1,0.8,1]},transition:{duration:2,repeat:Infinity,ease:\"easeInOut\",delay:0.1}})]})}),/*#__PURE__*/_jsxs(\"h4\",{className:\"text-xl font-semibold mb-2 \".concat(darkMode?'text-gray-200':'text-gray-800'),children:[\"Hi \",(user===null||user===void 0?void 0:user.name)||'there',\"! \\uD83D\\uDC4B\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"\".concat(darkMode?'text-gray-400':'text-gray-600',\" mb-6 text-lg\"),children:isRecording?\"Recording \".concat(recordingTimer,\"s...\"):isBotSpeaking?'I\\'m speaking...':'Start talking with the big microphone button below!'}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col space-y-2 max-w-md mx-auto\",children:suggestions.map((suggestion,index)=>/*#__PURE__*/_jsx(motion.button,{onClick:()=>sendTextMessage(suggestion),className:\"px-4 py-2 rounded-full text-sm transition-colors \".concat(darkMode?'bg-blue-900 text-blue-200 hover:bg-blue-800':'bg-blue-50 text-blue-600 hover:bg-blue-100'),whileHover:{scale:1.02},whileTap:{scale:0.98},children:suggestion},index))})]}):/*#__PURE__*/_jsx(AnimatePresence,{children:messages.map(message=>/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:\"flex \".concat(message.type==='user'?'justify-end':'justify-start'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-sm\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 rounded-2xl \".concat(message.type==='user'?darkMode?'bg-gradient-to-r from-blue-600 to-purple-700 text-white':'bg-gradient-to-r from-blue-500 to-purple-600 text-white':darkMode?'bg-gray-700 text-gray-100':'bg-gray-100 text-gray-900'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[message.type==='ai'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:\"\\uD83E\\uDD16\"}),message.type==='user'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:\"\\uD83D\\uDC76\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm leading-relaxed\",children:message.content})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mt-1 px-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs \".concat(darkMode?'text-gray-400':'text-gray-500'),children:formatTime(message.timestamp)}),message.audioData&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>playAudio(message.audioData),className:\"p-1 rounded transition-colors \".concat(darkMode?'text-blue-400 hover:text-blue-300 hover:bg-gray-700':'text-blue-500 hover:text-blue-600 hover:bg-blue-50'),children:/*#__PURE__*/_jsx(SpeakerWaveIcon,{className:\"w-4 h-4\"})})]})]})},message.id))}),isLoading&&/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0},animate:{opacity:1},className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3 rounded-2xl \".concat(darkMode?'bg-gray-700':'bg-gray-100'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:\"\\uD83E\\uDD16\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full animate-bounce \".concat(darkMode?'bg-blue-400':'bg-blue-500')}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full animate-bounce \".concat(darkMode?'bg-blue-400':'bg-blue-500'),style:{animationDelay:'0.1s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 rounded-full animate-bounce \".concat(darkMode?'bg-blue-400':'bg-blue-500'),style:{animationDelay:'0.2s'}})]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm \".concat(darkMode?'text-gray-300':'text-gray-600'),children:\"Thinking...\"})]})})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-shrink-0 border-t \".concat(darkMode?'border-gray-700 bg-gray-900':'border-gray-200 bg-gray-50'),children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-4 py-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center space-x-3\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsx(TextInput,{onSendMessage:sendTextMessage,isLoading:isLoading,darkMode:darkMode})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"px-4 pb-6 pt-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center\",children:[/*#__PURE__*/_jsxs(motion.button,{onMouseDown:handleMicPress,onMouseUp:handleMicRelease,onMouseLeave:handleMicRelease,onTouchStart:handleMicPress,onTouchEnd:handleMicRelease,onKeyDown:handleMicKeyDown,onKeyUp:handleMicKeyUp,className:\"relative w-20 h-20 rounded-full transition-all duration-200 select-none shadow-lg flex items-center justify-center \".concat(isRecording?'bg-gradient-to-br from-red-500 to-red-600 text-white scale-110 shadow-red-500/50':darkMode?'bg-gradient-to-br from-blue-600 to-blue-700 text-white hover:from-blue-500 hover:to-blue-600 shadow-blue-600/30':'bg-gradient-to-br from-blue-500 to-blue-600 text-white hover:from-blue-400 hover:to-blue-500 shadow-blue-500/30',\" \").concat(isLoading?'opacity-50':''),disabled:isLoading,tabIndex:0,whileHover:{scale:isLoading?1:1.05},whileTap:{scale:isLoading?1:0.95},animate:{boxShadow:isRecording?['0 0 0 0 rgba(239, 68, 68, 0.4)','0 0 0 20px rgba(239, 68, 68, 0)','0 0 0 0 rgba(239, 68, 68, 0.4)']:['0 0 0 0 rgba(59, 130, 246, 0.3)','0 0 0 10px rgba(59, 130, 246, 0)','0 0 0 0 rgba(59, 130, 246, 0.3)']},transition:{boxShadow:{duration:isRecording?1:2,repeat:Infinity,ease:\"easeOut\"}},children:[isRecording?/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col items-center justify-center\",children:[/*#__PURE__*/_jsx(StopIcon,{className:\"w-8 h-8 mb-1\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-bold\",children:[recordingTimer,\"s\"]})]}):/*#__PURE__*/_jsx(MicrophoneIcon,{className:\"w-8 h-8\"}),/*#__PURE__*/_jsx(AnimatePresence,{children:!isLoading&&/*#__PURE__*/_jsx(motion.div,{className:\"absolute inset-0 rounded-full border-2 \".concat(isRecording?'border-red-300':'border-blue-300'),initial:{scale:1,opacity:0.6},animate:{scale:1.8,opacity:0},exit:{opacity:0},transition:{duration:isRecording?1:2,repeat:Infinity,ease:\"easeOut\"}})})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center text-sm mt-3 font-medium \".concat(darkMode?'text-gray-400':'text-gray-600'),children:isRecording?\"\\uD83C\\uDFA4 Recording \".concat(recordingTimer,\"s - Release to send\"):'ðŸŽ¤ Press and hold to speak'})]})})]})]})});};export default SimplifiedChatInterface;","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","motion","AnimatePresence","MicrophoneIcon","StopIcon","PaperAirplaneIcon","SpeakerWaveIcon","SpeakerXMarkIcon","SparklesIcon","ChatBubbleLeftEllipsisIcon","SunIcon","MoonIcon","toast","TextInput","jsx","_jsx","jsxs","_jsxs","SimplifiedChatInterface","_ref","user","darkMode","setDarkMode","sessionId","messages","onAddMessage","isRecording","setIsRecording","isPlaying","setIsPlaying","isLoading","setIsLoading","isBotSpeaking","setIsBotSpeaking","currentTranscript","setCurrentTranscript","recordingTimer","setRecordingTimer","mediaRecorderRef","audioChunksRef","messagesEndRef","audioRef","recordingIntervalRef","streamRef","suggestions","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","startRecording","console","log","stream","navigator","mediaDevices","getUserMedia","audio","sampleRate","channelCount","echoCancellation","noiseSuppression","autoGainControl","options","mimeType","audioBitsPerSecond","MediaRecorder","isTypeSupported","ondataavailable","event","data","size","push","onstop","audioBlob","Blob","type","sendVoiceMessage","getTracks","forEach","track","stop","start","liveMessage","id","concat","Date","now","content","isVoice","isLive","timestamp","setInterval","prev","error","message","stopRecording","clearInterval","userMessage","arrayBuffer","uint8Array","Uint8Array","base64Audio","btoa","String","fromCharCode","length","formData","FormData","append","response","fetch","process","env","REACT_APP_BACKEND_URL","method","body","json","ok","status","aiMessage","response_text","audioData","response_audio","contentType","content_type","metadata","playAudio","success","Error","detail","errorMessage","sendTextMessage","messageText","trim","messageContent","headers","JSON","stringify","session_id","user_id","pause","from","atob","c","charCodeAt","audioUrl","URL","createObjectURL","Audio","play","onended","revokeObjectURL","stopAudio","currentTime","formatTime","date","isNaN","getTime","toLocaleTimeString","hour","minute","handleMicPress","e","preventDefault","handleMicRelease","handleMicKeyDown","key","handleMicKeyUp","getBackgroundClass","base","className","children","div","animate","opacity","transition","duration","repeat","Infinity","onClick","scale","ease","scaleY","delay","name","map","suggestion","index","button","whileHover","whileTap","initial","y","exit","style","animationDelay","ref","onSendMessage","onMouseDown","onMouseUp","onMouseLeave","onTouchStart","onTouchEnd","onKeyDown","onKeyUp","disabled","tabIndex","boxShadow"],"sources":["/app/frontend/src/components/SimplifiedChatInterface.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { \n  MicrophoneIcon, \n  StopIcon, \n  PaperAirplaneIcon,\n  SpeakerWaveIcon,\n  SpeakerXMarkIcon,\n  SparklesIcon,\n  ChatBubbleLeftEllipsisIcon,\n  SunIcon,\n  MoonIcon\n} from '@heroicons/react/24/outline';\nimport toast from 'react-hot-toast';\nimport TextInput from './TextInput';\n\nconst SimplifiedChatInterface = ({ user, darkMode, setDarkMode, sessionId, messages, onAddMessage }) => {\n  const [isRecording, setIsRecording] = useState(false);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isBotSpeaking, setIsBotSpeaking] = useState(false);\n  const [currentTranscript, setCurrentTranscript] = useState('');\n  const [recordingTimer, setRecordingTimer] = useState(0);\n  \n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const messagesEndRef = useRef(null);\n  const audioRef = useRef(null);\n  const recordingIntervalRef = useRef(null);\n  const streamRef = useRef(null);\n\n  const suggestions = [\n    \"Tell me a story\",\n    \"Sing a song\", \n    \"What's a fun fact?\",\n    \"Let's play a game\",\n    \"Help me learn something\"\n  ];\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  const startRecording = async () => {\n    try {\n      console.log('Starting recording...');\n      \n      // Reset states\n      setCurrentTranscript('');\n      setRecordingTimer(0);\n      \n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          sampleRate: 16000,\n          channelCount: 1,\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true\n        }\n      });\n      \n      streamRef.current = stream;\n      \n      // Use higher quality audio recording\n      const options = {\n        mimeType: 'audio/webm;codecs=opus',\n        audioBitsPerSecond: 128000\n      };\n      \n      // Fallback for browsers that don't support webm\n      if (!MediaRecorder.isTypeSupported(options.mimeType)) {\n        options.mimeType = 'audio/wav';\n      }\n      \n      mediaRecorderRef.current = new MediaRecorder(stream, options);\n      audioChunksRef.current = [];\n\n      mediaRecorderRef.current.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n          console.log('Audio chunk received:', event.data.size, 'bytes');\n        }\n      };\n\n      mediaRecorderRef.current.onstop = () => {\n        console.log('Recording stopped, processing audio...');\n        const audioBlob = new Blob(audioChunksRef.current, { \n          type: mediaRecorderRef.current.mimeType \n        });\n        console.log('Audio blob created:', audioBlob.size, 'bytes, type:', audioBlob.type);\n        sendVoiceMessage(audioBlob);\n        \n        // Clean up stream\n        if (streamRef.current) {\n          streamRef.current.getTracks().forEach(track => track.stop());\n          streamRef.current = null;\n        }\n      };\n\n      // Start recording with chunks every 100ms for better quality\n      mediaRecorderRef.current.start(100);\n      setIsRecording(true);\n      \n      // Add a live transcript message\n      const liveMessage = {\n        id: `recording-${Date.now()}`,\n        type: 'user',\n        content: 'ðŸŽ¤ Recording... (hold to continue)',\n        isVoice: true,\n        isLive: true,\n        timestamp: new Date()\n      };\n      onAddMessage(liveMessage);\n      \n      // Start recording timer\n      recordingIntervalRef.current = setInterval(() => {\n        setRecordingTimer(prev => prev + 1);\n      }, 1000);\n      \n      console.log('Recording started successfully');\n      \n    } catch (error) {\n      console.error('Microphone access error:', error);\n      toast.error(`Microphone access denied: ${error.message}`);\n    }\n  };\n\n  const stopRecording = () => {\n    console.log('Stopping recording...');\n    \n    if (mediaRecorderRef.current && isRecording) {\n      mediaRecorderRef.current.stop();\n      setIsRecording(false);\n      setRecordingTimer(0);\n      \n      // Clear recording timer\n      if (recordingIntervalRef.current) {\n        clearInterval(recordingIntervalRef.current);\n        recordingIntervalRef.current = null;\n      }\n      \n      // Remove live recording message by filtering it from current messages\n      // Since we can't modify the messages directly, we'll need to update the approach\n      // For now, we'll add a cleanup mechanism in the parent component\n      \n      console.log('Recording stop initiated');\n    }\n  };\n\n  const sendVoiceMessage = async (audioBlob) => {\n    console.log('Sending voice message, blob size:', audioBlob.size, 'type:', audioBlob.type);\n    \n    // Validate audio blob\n    if (!audioBlob || audioBlob.size === 0) {\n      console.error('Invalid audio blob');\n      toast.error('Recording failed - no audio data');\n      return;\n    }\n    \n    // Create temporary user message for processing\n    const userMessage = {\n      id: Date.now(),\n      type: 'user',\n      content: 'ðŸŽ¤ Processing voice...',\n      isVoice: true,\n      timestamp: new Date()\n    };\n\n    onAddMessage(userMessage);\n    setIsLoading(true);\n\n    try {\n      // Convert audio blob to ArrayBuffer first for better handling\n      const arrayBuffer = await audioBlob.arrayBuffer();\n      const uint8Array = new Uint8Array(arrayBuffer);\n      const base64Audio = btoa(String.fromCharCode(...uint8Array));\n      \n      console.log('Audio converted to base64, length:', base64Audio.length);\n      \n      // Create form data with proper content type\n      const formData = new FormData();\n      formData.append('session_id', sessionId);\n      formData.append('user_id', user.id);\n      formData.append('audio_base64', base64Audio);\n\n      console.log('Sending request to voice endpoint...');\n      \n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/voice/process_audio`, {\n        method: 'POST',\n        body: formData\n      });\n\n      const data = await response.json();\n      console.log('Voice processing response:', data);\n      \n      if (response.ok && data.status === 'success') {\n        // Add AI response\n        const aiMessage = {\n          id: Date.now() + 1,\n          type: 'ai',\n          content: data.response_text || 'I heard you!',\n          audioData: data.response_audio,\n          contentType: data.content_type,\n          metadata: data.metadata,\n          timestamp: new Date()\n        };\n\n        onAddMessage(aiMessage);\n        \n        // Auto-play AI response if available\n        if (data.response_audio) {\n          playAudio(data.response_audio);\n        }\n        \n        toast.success('Voice message processed!');\n      } else {\n        throw new Error(data.detail || data.message || 'Voice processing failed');\n      }\n      \n    } catch (error) {\n      console.error('Voice message error:', error);\n      toast.error(`Voice processing failed: ${error.message}`);\n      \n      // Add error message since we can't update existing message\n      const errorMessage = {\n        id: Date.now() + 1,\n        type: 'system',\n        content: 'âŒ Voice processing failed - try again',\n        timestamp: new Date()\n      };\n      onAddMessage(errorMessage);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const sendTextMessage = async (messageText) => {\n    if (!messageText || !messageText.trim() || isLoading) return;\n\n    const messageContent = messageText.trim();\n    \n    const userMessage = {\n      id: Date.now(),\n      type: 'user',\n      content: messageContent,\n      isVoice: false,\n      timestamp: new Date()\n    };\n\n    onAddMessage(userMessage);\n    setIsLoading(true);\n\n    try {\n      const response = await fetch(`${process.env.REACT_APP_BACKEND_URL}/api/conversations/text`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          session_id: sessionId,\n          user_id: user.id,\n          message: messageContent\n        })\n      });\n\n      const data = await response.json();\n      \n      if (response.ok) {\n        const aiMessage = {\n          id: Date.now() + 1,\n          type: 'ai',\n          content: data.response_text,\n          audioData: data.response_audio,\n          contentType: data.content_type,\n          metadata: data.metadata,\n          timestamp: new Date()\n        };\n\n        onAddMessage(aiMessage);\n        \n        // Auto-play AI response\n        if (data.response_audio) {\n          playAudio(data.response_audio);\n        }\n      } else {\n        throw new Error(data.detail || 'Failed to send message');\n      }\n    } catch (error) {\n      toast.error('Failed to send message');\n      console.error('Text message error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const playAudio = (base64Audio) => {\n    if (audioRef.current) {\n      audioRef.current.pause();\n    }\n    \n    const audioBlob = new Blob([Uint8Array.from(atob(base64Audio), c => c.charCodeAt(0))], { type: 'audio/wav' });\n    const audioUrl = URL.createObjectURL(audioBlob);\n    \n    audioRef.current = new Audio(audioUrl);\n    audioRef.current.play();\n    setIsPlaying(true);\n    setIsBotSpeaking(true);\n    \n    audioRef.current.onended = () => {\n      setIsPlaying(false);\n      setIsBotSpeaking(false);\n      URL.revokeObjectURL(audioUrl);\n    };\n  };\n\n  const stopAudio = () => {\n    if (audioRef.current) {\n      audioRef.current.pause();\n      audioRef.current.currentTime = 0;\n      setIsPlaying(false);\n      setIsBotSpeaking(false);\n    }\n  };\n\n  const formatTime = (timestamp) => {\n    // Ensure timestamp is a Date object\n    const date = timestamp instanceof Date ? timestamp : new Date(timestamp);\n    // Handle invalid dates\n    if (isNaN(date.getTime())) {\n      return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n    }\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\n  };\n\n  const handleMicPress = (e) => {\n    e.preventDefault();\n    console.log('Mic button pressed');\n    if (!isRecording && !isLoading) {\n      startRecording();\n    }\n  };\n\n  const handleMicRelease = (e) => {\n    e.preventDefault();\n    console.log('Mic button released');\n    if (isRecording) {\n      stopRecording();\n    }\n  };\n\n  // Handle keyboard interactions\n  const handleMicKeyDown = (e) => {\n    if (e.key === ' ' || e.key === 'Enter') {\n      e.preventDefault();\n      handleMicPress(e);\n    }\n  };\n\n  const handleMicKeyUp = (e) => {\n    if (e.key === ' ' || e.key === 'Enter') {\n      e.preventDefault();\n      handleMicRelease(e);\n    }\n  };\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (recordingIntervalRef.current) {\n        clearInterval(recordingIntervalRef.current);\n      }\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, []);\n\n  // Dynamic background based on bot speaking\n  const getBackgroundClass = () => {\n    const base = darkMode \n      ? 'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900'\n      : 'bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50';\n    \n    if (isBotSpeaking) {\n      return darkMode \n        ? 'bg-gradient-to-br from-purple-900 via-pink-900 to-orange-900'\n        : 'bg-gradient-to-br from-yellow-100 via-orange-100 to-pink-100';\n    }\n    \n    return base;\n  };\n\n  return (\n    <div className={`h-full ${getBackgroundClass()} transition-all duration-1000`}>\n      {/* Full Height Chat Interface - No more split panel layout */}\n      <div className=\"h-full flex flex-col\">\n        \n        {/* Header */}\n        <div className={`flex-shrink-0 p-4 border-b ${darkMode ? 'border-gray-700 bg-gray-900' : 'border-gray-200 bg-gray-50'}`}>\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <ChatBubbleLeftEllipsisIcon className={`w-6 h-6 ${darkMode ? 'text-blue-400' : 'text-blue-600'}`} />\n              <h3 className=\"text-lg font-semibold\">Chat with Buddy ðŸ¤–</h3>\n              \n              {/* Recording Status Indicator */}\n              {isRecording && (\n                <motion.div \n                  className=\"flex items-center space-x-2 text-red-500\"\n                  animate={{ opacity: [1, 0.5, 1] }}\n                  transition={{ duration: 1, repeat: Infinity }}\n                >\n                  <div className=\"w-3 h-3 bg-red-500 rounded-full\"></div>\n                  <span className=\"text-sm font-medium\">Recording {recordingTimer}s</span>\n                </motion.div>\n              )}\n              \n              {/* Bot Speaking Indicator */}\n              {isBotSpeaking && (\n                <motion.div \n                  className=\"flex items-center space-x-2 text-blue-500\"\n                  animate={{ opacity: [1, 0.7, 1] }}\n                  transition={{ duration: 0.8, repeat: Infinity }}\n                >\n                  <div className=\"w-3 h-3 bg-blue-500 rounded-full\"></div>\n                  <span className=\"text-sm font-medium\">Speaking...</span>\n                </motion.div>\n              )}\n            </div>\n            \n            <button\n              onClick={() => setDarkMode(!darkMode)}\n              className={`p-2 rounded-full transition-colors ${\n                darkMode ? 'bg-gray-700 text-yellow-400 hover:bg-gray-600' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n              }`}\n            >\n              {darkMode ? <SunIcon className=\"w-5 h-5\" /> : <MoonIcon className=\"w-5 h-5\" />}\n            </button>\n          </div>\n        </div>\n\n        {/* Messages Area - Full Height */}\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\n          {messages.length === 0 ? (\n            <div className=\"text-center py-12\">\n              {/* Animated Bot Avatar - Smaller and Centered */}\n              <motion.div\n                className={`mx-auto w-32 h-32 rounded-full flex items-center justify-center mb-6 ${\n                  darkMode ? 'bg-gradient-to-br from-blue-600 to-purple-700' : 'bg-gradient-to-br from-blue-500 to-purple-600'\n                }`}\n                animate={{\n                  scale: isBotSpeaking ? [1, 1.05, 1] : [1, 1.02, 1],\n                }}\n                transition={{\n                  scale: { duration: 2, repeat: Infinity, ease: \"easeInOut\" },\n                }}\n              >\n                {/* Eyes */}\n                <div className=\"flex space-x-4\">\n                  <motion.div \n                    className=\"w-4 h-8 bg-white rounded-full\"\n                    animate={{\n                      scaleY: isBotSpeaking ? [1, 0.3, 1] : [1, 0.8, 1]\n                    }}\n                    transition={{ duration: 2, repeat: Infinity, ease: \"easeInOut\" }}\n                  />\n                  <motion.div \n                    className=\"w-4 h-8 bg-white rounded-full\"\n                    animate={{\n                      scaleY: isBotSpeaking ? [1, 0.3, 1] : [1, 0.8, 1]\n                    }}\n                    transition={{ duration: 2, repeat: Infinity, ease: \"easeInOut\", delay: 0.1 }}\n                  />\n                </div>\n              </motion.div>\n              \n              <h4 className={`text-xl font-semibold mb-2 ${darkMode ? 'text-gray-200' : 'text-gray-800'}`}>\n                Hi {user?.name || 'there'}! ðŸ‘‹\n              </h4>\n              <p className={`${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-6 text-lg`}>\n                {isRecording ? `Recording ${recordingTimer}s...` : \n                 isBotSpeaking ? 'I\\'m speaking...' :\n                 'Start talking with the big microphone button below!'}\n              </p>\n              \n              <div className=\"flex flex-col space-y-2 max-w-md mx-auto\">\n                {suggestions.map((suggestion, index) => (\n                  <motion.button\n                    key={index}\n                    onClick={() => sendTextMessage(suggestion)}\n                    className={`px-4 py-2 rounded-full text-sm transition-colors ${\n                      darkMode \n                        ? 'bg-blue-900 text-blue-200 hover:bg-blue-800' \n                        : 'bg-blue-50 text-blue-600 hover:bg-blue-100'\n                    }`}\n                    whileHover={{ scale: 1.02 }}\n                    whileTap={{ scale: 0.98 }}\n                  >\n                    {suggestion}\n                  </motion.button>\n                ))}\n              </div>\n            </div>\n          ) : (\n            <AnimatePresence>\n              {messages.map((message) => (\n                <motion.div\n                  key={message.id}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -20 }}\n                  className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}\n                >\n                  <div className=\"max-w-sm\">\n                    <div\n                      className={`px-4 py-3 rounded-2xl ${\n                        message.type === 'user'\n                          ? darkMode \n                            ? 'bg-gradient-to-r from-blue-600 to-purple-700 text-white'\n                            : 'bg-gradient-to-r from-blue-500 to-purple-600 text-white'\n                          : darkMode\n                          ? 'bg-gray-700 text-gray-100'\n                          : 'bg-gray-100 text-gray-900'\n                      }`}\n                    >\n                      <div className=\"flex items-start space-x-2\">\n                        {message.type === 'ai' && (\n                          <span className=\"text-xl\">ðŸ¤–</span>\n                        )}\n                        {message.type === 'user' && (\n                          <span className=\"text-xl\">ðŸ‘¶</span>\n                        )}\n                        <p className=\"text-sm leading-relaxed\">{message.content}</p>\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between mt-1 px-2\">\n                      <span className={`text-xs ${darkMode ? 'text-gray-400' : 'text-gray-500'}`}>\n                        {formatTime(message.timestamp)}\n                      </span>\n                      \n                      {message.audioData && (\n                        <button\n                          onClick={() => playAudio(message.audioData)}\n                          className={`p-1 rounded transition-colors ${\n                            darkMode \n                              ? 'text-blue-400 hover:text-blue-300 hover:bg-gray-700' \n                              : 'text-blue-500 hover:text-blue-600 hover:bg-blue-50'\n                          }`}\n                        >\n                          <SpeakerWaveIcon className=\"w-4 h-4\" />\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                </motion.div>\n              ))}\n            </AnimatePresence>\n          )}\n          \n          {/* Loading Animation */}\n          {isLoading && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              className=\"flex justify-start\"\n            >\n              <div className={`px-4 py-3 rounded-2xl ${\n                darkMode ? 'bg-gray-700' : 'bg-gray-100'\n              }`}>\n                <div className=\"flex items-center space-x-2\">\n                  <span className=\"text-xl\">ðŸ¤–</span>\n                  <div className=\"flex space-x-1\">\n                    <div className={`w-2 h-2 rounded-full animate-bounce ${\n                      darkMode ? 'bg-blue-400' : 'bg-blue-500'\n                    }`}></div>\n                    <div className={`w-2 h-2 rounded-full animate-bounce ${\n                      darkMode ? 'bg-blue-400' : 'bg-blue-500'\n                    }`} style={{ animationDelay: '0.1s' }}></div>\n                    <div className={`w-2 h-2 rounded-full animate-bounce ${\n                      darkMode ? 'bg-blue-400' : 'bg-blue-500'\n                    }`} style={{ animationDelay: '0.2s' }}></div>\n                  </div>\n                  <span className={`text-sm ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>\n                    Thinking...\n                  </span>\n                </div>\n              </div>\n            </motion.div>\n          )}\n          \n          <div ref={messagesEndRef} />\n        </div>\n\n        {/* Bottom Input Area with Large Mic Button */}\n        <div className={`flex-shrink-0 border-t ${darkMode ? 'border-gray-700 bg-gray-900' : 'border-gray-200 bg-gray-50'}`}>\n          \n          {/* Text Input Row */}\n          <div className=\"px-4 py-3\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"flex-1\">\n                <TextInput \n                  onSendMessage={sendTextMessage} \n                  isLoading={isLoading}\n                  darkMode={darkMode}\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Large Centered Microphone Button */}\n          <div className=\"px-4 pb-6 pt-2\">\n            <div className=\"flex flex-col items-center\">\n              <motion.button\n                onMouseDown={handleMicPress}\n                onMouseUp={handleMicRelease}\n                onMouseLeave={handleMicRelease}\n                onTouchStart={handleMicPress}\n                onTouchEnd={handleMicRelease}\n                onKeyDown={handleMicKeyDown}\n                onKeyUp={handleMicKeyUp}\n                className={`relative w-20 h-20 rounded-full transition-all duration-200 select-none shadow-lg flex items-center justify-center ${\n                  isRecording \n                    ? 'bg-gradient-to-br from-red-500 to-red-600 text-white scale-110 shadow-red-500/50' \n                    : darkMode\n                    ? 'bg-gradient-to-br from-blue-600 to-blue-700 text-white hover:from-blue-500 hover:to-blue-600 shadow-blue-600/30'\n                    : 'bg-gradient-to-br from-blue-500 to-blue-600 text-white hover:from-blue-400 hover:to-blue-500 shadow-blue-500/30'\n                } ${isLoading ? 'opacity-50' : ''}`}\n                disabled={isLoading}\n                tabIndex={0}\n                whileHover={{ scale: isLoading ? 1 : 1.05 }}\n                whileTap={{ scale: isLoading ? 1 : 0.95 }}\n                animate={{\n                  boxShadow: isRecording \n                    ? ['0 0 0 0 rgba(239, 68, 68, 0.4)', '0 0 0 20px rgba(239, 68, 68, 0)', '0 0 0 0 rgba(239, 68, 68, 0.4)']\n                    : ['0 0 0 0 rgba(59, 130, 246, 0.3)', '0 0 0 10px rgba(59, 130, 246, 0)', '0 0 0 0 rgba(59, 130, 246, 0.3)']\n                }}\n                transition={{\n                  boxShadow: { duration: isRecording ? 1 : 2, repeat: Infinity, ease: \"easeOut\" }\n                }}\n              >\n                {isRecording ? (\n                  <div className=\"flex flex-col items-center justify-center\">\n                    <StopIcon className=\"w-8 h-8 mb-1\" />\n                    <span className=\"text-xs font-bold\">{recordingTimer}s</span>\n                  </div>\n                ) : (\n                  <MicrophoneIcon className=\"w-8 h-8\" />\n                )}\n                \n                {/* Pulsing Animation Ring */}\n                <AnimatePresence>\n                  {!isLoading && (\n                    <motion.div\n                      className={`absolute inset-0 rounded-full border-2 ${\n                        isRecording ? 'border-red-300' : 'border-blue-300'\n                      }`}\n                      initial={{ scale: 1, opacity: 0.6 }}\n                      animate={{ scale: 1.8, opacity: 0 }}\n                      exit={{ opacity: 0 }}\n                      transition={{ \n                        duration: isRecording ? 1 : 2, \n                        repeat: Infinity, \n                        ease: \"easeOut\" \n                      }}\n                    />\n                  )}\n                </AnimatePresence>\n              </motion.button>\n              \n              {/* Instructions */}\n              <p className={`text-center text-sm mt-3 font-medium ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}>\n                {isRecording \n                  ? `ðŸŽ¤ Recording ${recordingTimer}s - Release to send` \n                  : 'ðŸŽ¤ Press and hold to speak'}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default SimplifiedChatInterface;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}